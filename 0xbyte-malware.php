<?php
error_reporting(0);
// Copyright (c)2019 - Afrizal F.A - ICWR-TECH
echo "\n";
echo "####################################\n";
echo "#      0xbyt3 - Anti-Malware       #\n";
echo "# Coded By Afrizal F.A - ICWR-TECH #\n";
echo "####################################\n";
echo "\n";
echo "[+] Download Database.....\n";
$dbscan = file_get_contents("https://raw.githubusercontent.com/ICWR-TECH/0xbyt3-anti-malware/master/analyze-malware.db");
echo "[+] Scanning Database.....\n";
sleep(1);
$split = explode("^", $dbscan);
function scand($dir, $scn){
	$files = array_diff(scandir($dir), array('.', '..'));
	foreach($files as $file) {
		if(is_dir($dir."/".$file)){
				scand($dir."/".$file, $scn);
			} else {
				$namef = $dir."/".$file;
        $file = file_get_contents($namef);
				if(preg_match("/$scn/", $file)) {
					$dtc = "[+] File : $namef => Malware Detected !!! ( $scn )\n";
					echo $dtc;
				}
			}
		}
}
foreach($split as $scan) {
    scand($argv[1], $scan);
}
echo "\n";
?>
